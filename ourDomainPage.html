<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Our Domain Page</title>
    <style>
        :root{
            --genislik:50%;
        }
        #iFrame{
            width: var(--genislik);
        }
        #secretCalculationDiv{
            width: var(--genislik);
            top:-1000px;
            padding:0;
        }
    </style>
    <script>

        window.addEventListener('load',()=>{

        });

        let iFrameSizePredictor = (theTarget)=>{
            let targetSourceCode = fetch(theTarget).then(response => response.text()).then(txt=>{
                const domparser = new DOMParser();
                const doc = domparser.parseFromString(txt, 'text/html');
                console.log('Fetch edildi');


                // 2. plan
                let secretDiv = document.createElement('div');
                secretDiv.id = 'secretCalculationDiv';
                secretDiv.innerHTML = txt;
                document.body.append(secretDiv);
                console.log('secret div yaratildi ve body e eklendi!');
                let childrenOfSecretDiv =  secretDiv.children;
                let cumulHeight = 0;
                Object.values(childrenOfSecretDiv).forEach(item=>{
                    let thisHeight = parseInt(getComputedStyle(item).height)|0;
                    let thisTopMargin= parseInt(getComputedStyle(item).marginTop)|0;
                    //let thisBottomMargin= parseInt(getComputedStyle(item).marginBottom)|0;
                    let thisTopPadding= parseInt(getComputedStyle(item).paddingTop)|0;
                    //let thisBottomPadding= parseInt(getComputedStyle(item).paddingBottom)|0;
                //cumulHeight+= thisHeight + thisTopMargin + thisBottomMargin +thisTopPadding + thisBottomPadding;
                cumulHeight+= thisHeight + thisTopMargin  +thisTopPadding ;
                })
                console.log(`Toplam yukseklik: ${cumulHeight}`);
                document.querySelector('#iFrame').style.height=cumulHeight+'px';







                //1. plan -> render edilmediklerinden getComputedStyle ise yaramiyor, burada CSS varsa onlar tek tek bakilip (metinde arama ile) toplanabilir.
                // let childrenOfBody =  doc.body.children;
                // Object.values(childrenOfBody).forEach(item=>{
                //     console.log(getComputedStyle(item).height);
                // })



            })
        }

    </script>
</head>
<body>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In tristique felis vel viverra vulputate. Integer tincidunt, justo ut aliquet aliquam, nisl tellus molestie justo, nec elementum ligula nulla ullamcorper metus. Donec nec rhoncus risus, vel sodales neque. Nulla nulla metus, pharetra vitae massa vitae, mollis pretium eros. In hac habitasse platea dictumst. Mauris sollicitudin consectetur lorem, quis efficitur ipsum consectetur sit amet. Nunc tellus leo, imperdiet a scelerisque eget, bibendum a felis. Integer luctus venenatis est nec ornare. Nunc ullamcorper commodo turpis, in sagittis felis semper a.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In tristique felis vel viverra vulputate. Integer tincidunt, justo ut aliquet aliquam, nisl tellus molestie justo, nec elementum ligula nulla ullamcorper metus. Donec nec rhoncus risus, vel sodales neque. Nulla nulla metus, pharetra vitae massa vitae, mollis pretium eros. In hac habitasse platea dictumst. Mauris sollicitudin consectetur lorem, quis efficitur ipsum consectetur sit amet. Nunc tellus leo, imperdiet a scelerisque eget, bibendum a felis. Integer luctus venenatis est nec ornare. Nunc ullamcorper commodo turpis, in sagittis felis semper a.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In tristique felis vel viverra vulputate. Integer tincidunt, justo ut aliquet aliquam, nisl tellus molestie justo, nec elementum ligula nulla ullamcorper metus. Donec nec rhoncus risus,
    vel sodales neque. Nulla nulla metus, pharetra vitae massa vitae, mollis pretium eros. In hac habitasse platea dictumst. Mauris sollicitudin consectetur lorem, quis efficitur ipsum consectetur sit amet. Nunc tellus leo, imperdiet a scelerisque eget, bibendum a felis. Integer luctus venenatis est nec ornare. Nunc ullamcorper commodo turpis, in sagittis felis semper a.</p>
<iframe id="iFrame" src="./foreignDomainPage.html" onload="iFrameSizePredictor(this.src)">
    before loading...
</iframe>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In tristique felis vel viverra vulputate. Integer tincidunt, justo ut aliquet aliquam, nisl tellus molestie justo, nec elementum ligula nulla ullamcorper metus. Donec nec rhoncus risus, vel sodales neque. Nulla nulla metus, pharetra vitae massa vitae, mollis pretium eros. In hac habitasse platea dictumst. Mauris sollicitudin consectetur lorem, quis efficitur ipsum consectetur sit amet. Nunc tellus leo, imperdiet a scelerisque eget, bibendum a felis. Integer luctus venenatis est nec ornare. Nunc ullamcorper commodo turpis, in sagittis felis semper a.</p>

<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In tristique felis vel viverra vulputate. Integer tincidunt, justo ut aliquet aliquam, nisl tellus molestie justo, nec elementum ligula nulla ullamcorper metus. Donec nec rhoncus risus, vel sodales neque. Nulla nulla metus, pharetra vitae massa vitae, mollis pretium eros. In hac habitasse platea dictumst. Mauris sollicitudin consectetur lorem, quis efficitur ipsum consectetur sit amet. Nunc tellus leo, imperdiet a scelerisque eget, bibendum a felis. Integer luctus venenatis est nec ornare. Nunc ullamcorper commodo turpis, in sagittis felis semper a.</p>

<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In tristique felis vel viverra vulputate. Integer tincidunt, justo ut aliquet aliquam, nisl tellus molestie justo, nec elementum ligula nulla ullamcorper metus. Donec nec rhoncus risus, vel sodales neque. Nulla nulla metus, pharetra vitae massa vitae, mollis pretium eros. In hac habitasse platea dictumst. Mauris sollicitudin consectetur lorem, quis efficitur ipsum consectetur sit amet. Nunc tellus leo, imperdiet a scelerisque eget, bibendum a felis. Integer luctus venenatis est nec ornare. Nunc ullamcorper commodo turpis, in sagittis felis semper a.</p>


</body>
</html>
